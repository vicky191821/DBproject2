CREATE INDEX idx_player_validations_player_id ON PLAYER_VALIDATIONS (PLAYER_ID);
CREATE INDEX idx _player_validations_market_value ON PLAYER_VALIDATIONS (MARKEI_VALUE_IN _EUR) ;
CREATE INDEX idx players player_id ON PLAYERS (PLAYER_ID);
CREATE INDEX idx_clubs_club_id ON CLUBS (CLUB_ID) ;
CREATE INDEX idx_birth ON PLAYERS (DATE_OF_BIRTH) ;
SELECT CLUBS . CLUB_ID, CLUBS.NAME, AVG(PLAYER _VALIDATIONS.MARKET_VALUE_IN_EUR)
FROM PLAYER_VALIDATIONS JOIN PLAYERS ON PLAYER_VALIDATIONS.PLAYER_ID = PLAYERS. PLAYER_ID
  JOIN CLUBS ON CLUBS.CLUB_ID = PLAYERS.CURRENT_CLUB_ID
WHERE PLAYER_VALIDATIONS.MARKET_VALUE_IN_EUR>4000000
  AND (2023-EXTRACT (YEAR FROM TO_DATE (PLAYERS. DATE_OF_BIRTH, 'yyyy-mm-dd'))<30)
GROUP BY CLUBS.CLUB_ID,CLUBS.NAME
ORDER BY AVG (PLAYER_VALIDATIONS.MARKET_VALUE_IN _EUR) DESC;
