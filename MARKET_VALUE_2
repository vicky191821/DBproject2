SELECT CLUBS.CLUB ID, CLUBS.NAME, AVG (PLAYER VALIDATIONS.MARKET VALUE IN EUR)
FROM PLAYER VALIDATIONS JOIN PLAYERS ON PLAYER_VALIDATIONS. PLAYER_ID = PLAYERS. PLAYER_ID AND PLAYER_VALIDATIONS.MARKET_VALUE_IN EUR >4000000
JOIN CLUBS ON CLUBS.CLUB ID = PLAYERS.CURRENI CLUB ID
WHERE (2023-EXTRACT (YEAR FROM TODATE (PLAYERS. DATE_OF_BIRTH, 'yyyy-mm-dd'))<30)
GROUP BY CLUBS.CLUB ID,CLUBS.NAME
ORDER BY AVG (PLAYER_VALIDATIONS. MARKET_VALUE_IN_EUR) DESC;
