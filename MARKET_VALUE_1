SELECT CLUBS. CLUB_ID, CLUBS.NAME, AVG (PLAYER_VALIDATIONS.MARKET_VALUE_IN_EUR)
FROM PLAYER_VALIDATIONS JOIN PLAYERS ON PLAYER_VALIDAIIONS. PLAYER_ID = PLAYERS. PLAYER_ID AND PLAYER_VALIDAIIONS.MARKET_VALUE_IN_EUR >4000000
  JOIN CLUBS ON CLUBS.CLUB_ID = PLAYERS.CURRENT_CLUB_ID
WHERE (2023-EXTRACT (YEAR FROM TO DATE (PLAYERS. DATE_OF_BIRTH, ' yyyy-mm-dd'))<30)
GROUP BY CLUBS.CLUB_ID,CLUBS.NAME
ORDER BY AVG (PLAYER_VALIDATIONS. MARKET_VALUE_IN_EUR) DESC;
