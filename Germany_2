CREATE INDEX idx_country_citizenship ON PLAYERS(COUNTRY_OF_CITIZENSHIP);
--這個索引可以加速根據國籍過濾的查詢。
CREATE INDEX idx_date_of_birth ON PLAYERS(DATE_OF_BIRTH);
--這個索引可以加速根據生日過濾的查詢。
CREATE INDEX idx_player_id ON PLAYER_VALIDATIONS(PLAYER_ID);
--這個索引可以加速 JOIN 操作，因為在 WHERE 子句中使用了 PLAYERS.PLAYER_ID = PLAYER_VALIDATIONS.PLAYER_ID 的條件。

SELECT  AVG(PLAYER_VALIDATIONS.MARKET_VALUE_IN_EUR) AS  Aries_GERMAN_PLAYERS_AVG_VALIDATIONS
FROM PLAYERS JOIN PLAYER_VALIDATIONS  ON PLAYERS.PLAYER_ID = PLAYER_VALIDATIONS.PLAYER_ID
WHERE COUNTRY_OF_CITIZENSHIP = 'Germany'
AND EXTRACT(MONTH FROM TO_DATE(DATE_OF_BIRTH, 'YYYY-MM-DD')) = 3
  AND EXTRACT(DAY FROM TO_DATE(DATE_OF_BIRTH, 'YYYY-MM-DD')) BETWEEN 21 AND 31
  OR (EXTRACT(MONTH FROM TO_DATE(DATE_OF_BIRTH, 'YYYY-MM-DD')) = 4
  AND EXTRACT(DAY FROM TO_DATE(DATE_OF_BIRTH, 'YYYY-MM-DD')) BETWEEN 1 AND 19)
